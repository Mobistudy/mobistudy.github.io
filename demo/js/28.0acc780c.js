(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"71a8":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"row fit justify-center"},[r("div",{staticClass:"text-h5 text-center q-pt-md"},[e._v("\n      "+e._s(e.$t("accountMgmt.profile.profile"))+"\n    ")])]),r("profile-editor",{attrs:{buttonOk:e.$t("common.update")},on:{buttonOk:function(t){return e.saveProfile()}},model:{value:e.profile,callback:function(t){e.profile=t},expression:"profile"}}),r("q-separator"),r("q-item",{staticClass:"q-mt-md"},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{color:"grey",name:"security"}})],1),r("q-item-section",[r("q-item-label",[e._v(e._s(e.$t("accountMgmt.resetPassword.resetPassword")))]),r("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$t("accountMgmt.resetPassword.resetPasswordShort")))]),r("div",{staticClass:"q-my-md"},[r("q-btn",{attrs:{color:"primary",label:e.$t("accountMgmt.resetPassword.resetPassword")},on:{click:function(t){return e.resetPwd()}}})],1)],1)],1),r("q-separator",{attrs:{inset:""}}),r("q-item",{staticClass:"q-mt-md"},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{color:"grey",name:"exit_to_app"}})],1),r("q-item-section",[r("q-item-label",[e._v(e._s(e.$t("accountMgmt.login.logout")))]),r("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$t("accountMgmt.login.logoutShort")))]),r("div",{staticClass:"q-my-md"},[r("q-btn",{attrs:{color:"warning",to:"Login",label:e.$t("accountMgmt.login.logout")}})],1)],1)],1),r("q-separator",{attrs:{inset:""}}),r("q-item",{staticClass:"q-mt-md"},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{color:"grey",name:"delete_forever"}})],1),r("q-item-section",[r("q-item-label",[e._v(e._s(e.$t("accountMgmt.deleteAccount")))]),r("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$t("accountMgmt.deleteShort")))]),r("div",{staticClass:"q-my-md"},[r("q-btn",{attrs:{color:"negative",label:e.$t("common.delete")},on:{click:function(t){return e.deleteUser()}}})],1)],1)],1)],1)},n=[],o=(r("7f7f"),r("967e")),s=r.n(o),i=(r("96cf"),r("fa84")),c=r.n(i),l=r("b006"),u=r("aa9c"),p=r("6a6d"),m=r("ee76"),f=r("9bf1"),d={name:"ProfilePage",components:{ProfileEditor:l["a"]},data:function(){return{profile:{name:"",surname:"",dateOfBirth:"",country:"",language:"",sex:"",diseases:[],medications:[],lifestyle:{smoker:!1,active:!1}}}},created:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.prev=1,t.next=4,u["a"].getProfile(f["a"].user._key);case 4:return e.profile=t.sent,t.next=7,f["a"].setProfile(e.profile);case 7:e.$q.loading.hide(),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](1),e.$q.notify({color:"negative",message:e.$i18n.t("errors.connectionError")+": "+t.t0.message,icon:"report_problem"}),e.$q.loading.hide();case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))()},methods:{saveProfile:function(){var e=this;return c()(s.a.mark((function t(){var r,a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r="",e.profile.dateOfBirth instanceof Date?r=e.profile.dateOfBirth.toISOString().substring(0,10):"string"===typeof e.profile.dateOfBirth?r=e.profile.dateOfBirth.substring(0,10):(r=e.profile.dateOfBirth,console.error(e.profile.dateOfBirth+" cannot be cut to date only")),a={userKey:f["a"].user._key,updatedTS:new Date,name:e.profile.name,surname:e.profile.surname,dateOfBirth:r,country:e.profile.country,language:e.profile.language,sex:e.profile.sex,weight:e.profile.weight,height:e.profile.height,diseases:e.profile.diseases,medications:e.profile.medications,lifestyle:e.profile.lifestyle},t.next=6,u["a"].updateProfile(a);case 6:return t.next=8,f["a"].setProfile(a);case 8:e.$router.push({name:"tasker",params:{rescheduleTasks:!0,checkNewStudies:!0}}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),e.$q.notify({color:"negative",message:e.$i18n.t("errors.connectionError")+": "+t.t0.message,icon:"report_problem"});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},resetPwd:function(){var e=this;return c()(s.a.mark((function t(){var r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].resetPW(f["a"].user.email.toLowerCase());case 3:r=f["a"].user.email,m["a"].cancelAll(),f["a"].logout(),u["a"].unsetToken(),p["a"].emptyUserData(),e.$router.push({name:"changepw",params:{email:r}}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),e.$q.notify({color:"negative",message:e.$i18n.t("errors.connectionError")+": "+t.t0.message,icon:"report_problem"});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},deleteUser:function(){var e=this;return c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$q.dialog({title:"Warning",message:"Deleting your user will delete all the data permanently for all studies. Are you sure you want to continue?",ok:{label:"DELETE",push:!0,color:"negative"},cancel:{push:!0,color:"grey",flat:!0}}).onOk(c()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["a"].deleteUser(f["a"].user.user._key);case 3:e.$router.push("/login"),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.$q.notify({color:"negative",message:e.$i18n.t("errors.connectionError")+": "+t.t0.message,icon:"report_problem"});case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))));case 1:case"end":return t.stop()}}),t)})))()}}},g=d,h=r("2877"),v=r("9989"),q=r("eb85"),w=r("66e5"),b=r("4074"),y=r("0016"),$=r("0170"),k=r("9c40"),_=r("eebe"),x=r.n(_),P=Object(h["a"])(g,a,n,!1,null,null,null);t["default"]=P.exports;x()(P,"components",{QPage:v["a"],QSeparator:q["a"],QItem:w["a"],QItemSection:b["a"],QIcon:y["a"],QItemLabel:$["a"],QBtn:k["a"]})}}]);