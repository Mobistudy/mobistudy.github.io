(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[56],{da89:function(s,e,t){"use strict";t.r(e);var r=function(){var s=this,e=s._self._c;return e("q-page",{attrs:{padding:""}},[e("div",{staticClass:"text-center text-h6 q-mt-lg"},[s._v("\n    "+s._s(s.$t("studies.tasks.peakflow.measurement"))+"\n  ")]),e("div",{staticClass:"text-center q-mt-lg"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!s.isMeasuring&&!(s.testErrors>s.maxErrors)&&0==s.completedTests,expression:"!isMeasuring && !(testErrors > maxErrors) && completedTests==0"}]},[e("div",[e("img",{staticStyle:{"max-width":"50%"},attrs:{src:"instructions/peakflow_3.svg"}})]),e("p",[s._v("\n        "+s._s(s.$t("studies.tasks.peakflow.measurementStart"))+"\n      ")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:s.isMeasuring,expression:"isMeasuring"}]},[e("div",[e("img",{staticStyle:{"max-width":"50%"},attrs:{src:"instructions/peakflow_4.svg"}})]),e("p",[s._v("\n        "+s._s(s.$t("studies.tasks.peakflow.measurementInstructions"))+"\n      ")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.isMeasuring&&s.completedTests>0&&!(s.testErrors>s.maxErrors),expression:"!isMeasuring && (completedTests>0) && !(testErrors > maxErrors)"}],staticClass:"text-center text-h6 q-mt-lg",staticStyle:{"min-height":"236px"}},s._l(s.PEFs,(function(t,r){return e("p",{key:"pef"+r,attrs:{data:t}},[s._v("\n        "+s._s(r+1)+") "+s._s(t)+" L/min\n      ")])})),0),e("p",{directives:[{name:"show",rawName:"v-show",value:!s.isMeasuring&&!(s.testErrors>s.maxErrors)&&1==s.completedTests,expression:"!isMeasuring && !(testErrors > maxErrors) && completedTests==1"}]},[s._v("\n      "+s._s(s.$t("studies.tasks.peakflow.measurementCompleted1"))+"\n    ")]),e("p",{directives:[{name:"show",rawName:"v-show",value:!s.isMeasuring&&!(s.testErrors>s.maxErrors)&&2==s.completedTests,expression:"!isMeasuring && !(testErrors > maxErrors) && completedTests==2"}]},[s._v("\n      "+s._s(s.$t("studies.tasks.peakflow.measurementCompleted2"))+"\n    ")]),e("p",{directives:[{name:"show",rawName:"v-show",value:!s.isMeasuring&&!(s.testErrors>s.maxErrors)&&3==s.completedTests,expression:"!isMeasuring && !(testErrors > maxErrors) && completedTests==3"}]},[s._v("\n      "+s._s(s.$t("studies.tasks.peakflow.measurementCompleted3"))+"\n    ")]),e("p",{directives:[{name:"show",rawName:"v-show",value:s.testErrors>s.maxErrors,expression:"testErrors > maxErrors"}],staticClass:"text-weight-bold text-negative q-pa-md"},[s._v("\n      "+s._s(s.$t("studies.tasks.peakflow.measurementErrorMaxRetries"))+"\n    ")])]),e("div",{staticClass:"row justify-center q-mt-lg"},[e("q-btn",{directives:[{name:"show",rawName:"v-show",value:!(s.testErrors>s.maxErrors)&&(s.isMeasuring||s.completedTests<=s.totalTestsNumber),expression:"!(testErrors > maxErrors) && (isMeasuring || (completedTests <= totalTestsNumber))"}],attrs:{color:"primary",disable:s.isMeasuring,label:s.$t("common.start")},on:{click:s.startMeasurement}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:s.completedTests>s.totalTestsNumber&&!s.isMeasuring,expression:"completedTests > totalTestsNumber && !isMeasuring"}],attrs:{color:"primary",label:s.$t("common.next")},on:{click:s.completeTest}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:s.testErrors>s.maxErrors,expression:"testErrors > maxErrors"}],attrs:{color:"primary",label:s.$t("common.next")},on:{click:s.abandonTest}})],1)])},a=[],o=(t("d9e2"),t("14d9"),t("ddb0"),t("a5f6")),i=t("ed5d"),n=t("9bf1"),m={name:"PeakFlowPage",props:{studyKey:String,taskId:Number},components:{},data:function(){return{isCompleted:!1,isMeasuring:!1,completedTests:0,totalTestsNumber:2,testErrors:0,maxErrors:4,measurement:void 0,PEFs:[]}},methods:{async startMeasurement(){if(this.completedTests<=this.totalTestsNumber){this.isMeasuring=!0;try{if(this.measurement=await i["a"].startMeasurement(),this.measurement.pef>1e3)throw new Error("PEF is too high");this.completedTests++,this.PEFs.push(this.measurement.pef)}catch(s){this.testErrors++,console.error(s),this.$q.notify({color:"negative",message:this.$t("studies.tasks.peakflow.measurementError"),icon:"report_problem"})}this.isMeasuring=!1}await i["a"].stopMeasurement()},completeTest(){const s=this.studyKey,e=parseInt(this.taskId),t=n["a"].user._key;let r={userKey:t,studyKey:s,taskId:e,createdTS:new Date,phone:o["a"].device,PEFs:this.PEFs,pefMax:Math.max(...this.PEFs)};this.$router.push({name:"peakFlowSummary",params:{report:r}})},abandonTest(){this.$router.push({name:"tasker"})}},beforeDestroy:function(){i["a"].stopMeasurement()}},u=m,l=t("2877"),p=t("9989"),c=t("9c40"),d=t("eebe"),h=t.n(d),w=Object(l["a"])(u,r,a,!1,null,null,null);e["default"]=w.exports;h()(w,"components",{QPage:p["a"],QBtn:c["a"]})}}]);