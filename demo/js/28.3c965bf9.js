(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"906a":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"text-h5 text-center"},[t._v("\n    "+t._s(t.$t("studies.consent.informedConsent"))+"\n  ")]),s("div",{staticClass:"text-body2"},[t._v("\n    "+t._s(t.$t("studies.consent.consentExplanation"))+"\n  ")]),s("consents",{attrs:{studyDescription:t.studyDescription},model:{value:t.studyParticipation,callback:function(e){t.studyParticipation=e},expression:"studyParticipation"}}),s("div",{staticClass:"q-my-md row justify-evenly"},[s("q-btn",{attrs:{label:t.$t("common.reject"),color:"negative",flat:""},on:{click:function(e){return t.deny()}}}),s("q-btn",{attrs:{label:t.$t("studies.consent.joinStudy"),color:"primary",disabled:!t.canAccept},on:{click:function(e){return t.accept()}}})],1)],1)},n=[],a=(s("13d5"),s("b6bd")),o=s("9bf1"),r=s("6a6d"),c=s("c313"),d={name:"ConsentItemsPage",props:["studyDescription"],components:{Consents:a["a"]},data(){return{studyParticipation:{studyKey:this.studyDescription._key,currentStatus:void 0,acceptedTS:void 0,reminders:!1,taskItemsConsent:[],extraItemsConsent:[]}}},async created(){if(this.studyDescription.consent.extraItems&&this.studyDescription.consent.extraItems.length)for(let t=0;t<this.studyDescription.consent.extraItems.length;t++)this.studyParticipation.extraItemsConsent.push({consented:!1});for(let t=0;t<this.studyDescription.consent.taskItems.length;t++)this.studyParticipation.taskItemsConsent.push({taskId:this.studyDescription.consent.taskItems[t].taskId,consented:!1})},computed:{canAccept(){let t=this.studyParticipation.taskItemsConsent.reduce(((t,e)=>t+e.consented),0);if(0===t)return!1;if(this.studyDescription.consent.extraItems&&this.studyDescription.consent.extraItems.length)for(let e=0;e<this.studyDescription.consent.extraItems.length;e++)if(!this.studyDescription.consent.extraItems[e].optional&&!this.studyParticipation.extraItemsConsent.consented)return!1;return!0}},methods:{async accept(){try{this.studyParticipation.currentStatus="accepted",this.studyParticipation.acceptedTS=new Date,await c["a"].updateStudyStatus(o["a"].user._key,this.studyDescription._key,this.studyParticipation);let t=await r["a"].getStudiesParticipation();t||(t=[]),t.push(this.studyParticipation),await r["a"].setStudiesParticipation(t),this.$router.push({name:"studies"})}catch(t){console.error("Cannot join study",t),this.$q.notify({color:"negative",message:this.$i18n.t("errors.connectionError")+": "+t.message,icon:"report_problem"})}this.$router.push({name:"accepted",params:{studyDescription:this.studyDescription}})},async deny(){this.$q.dialog({title:this.$i18n.t("studies.discardStudy"),message:this.$i18n.t("studies.discardStudyConfirm"),color:"primary",ok:this.$i18n.t("common.yes"),cancel:this.$i18n.t("common.cancel")}).onOk((async()=>{this.studyParticipation.currentStatus="rejected",this.studyParticipation.rejectedTS=new Date;try{await c["a"].updateStudyStatus(o["a"].user._key,this.studyDescription._key,this.studyParticipation);let t=await r["a"].getStudiesParticipation();t||(t=[]),t.push(this.studyParticipation),await r["a"].setStudiesParticipation(t),this.$router.push({name:"studies"})}catch(t){console.error("Cannot connect to server",t),this.$q.notify({color:"negative",message:this.$i18n.t("errors.connectionError")+": "+t.message,icon:"report_problem"})}}))}}},u=d,p=s("2877"),y=s("9989"),h=s("9c40"),l=s("eebe"),m=s.n(l),P=Object(p["a"])(u,i,n,!1,null,null,null);e["default"]=P.exports;m()(P,"components",{QPage:y["a"],QBtn:h["a"]})}}]);