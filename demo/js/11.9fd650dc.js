(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"375b":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("q-page",{attrs:{padding:""}},[e("div",{staticClass:"text-center text-h5 q-mt-lg"},[t._v("\n    "+t._s(t.$t("studies.tasks.tugt.title"))+"\n  ")]),e("div",{ref:"map",staticClass:"row justify-center items-center",staticStyle:{width:"100%",height:"50vh"}},[e("WalkingMan")],1),e("div",{staticClass:"row justify-center q-mt-lg"},[e("q-btn",{directives:[{name:"show",rawName:"v-show",value:!t.isStarted,expression:"!isStarted"}],attrs:{color:"primary",label:t.$t("common.start")},on:{click:t.startTest}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.isStarted,expression:"isStarted"}],attrs:{color:"secondary",label:t.$t("common.complete")},on:{click:t.completeTest}})],1)])},a=[],o=(s("14d9"),s("a5f6")),n=s("9bf1"),r=s("7937"),c=s("ea6a");const l=180;let m=[],d=[];var p={name:"TUGTPage",props:{studyKey:String,taskId:Number},components:{WalkingMan:c["a"]},data:function(){return{isSignalCheck:!0,isStarted:!1,isCompleted:!1,timer:void 0,totalTime:l,startedTS:void 0,distance:0}},mounted:async function(){},methods:{async startTest(){this.isStarted=!0,this.startedTS=new Date,this.startTimer(),o["a"].screen.forbidSleep(),m=[],d=[];try{await o["a"].orientation.isAvailable()&&(await o["a"].orientation.requestPermission(),o["a"].orientation.startNotifications({},(t=>{m.push(t)}),(t=>{console.error("Error getting orientation event",t)})))}catch(t){console.error("Issues getting OrientationEvent",t)}try{await o["a"].motion.isAvailable()&&(await o["a"].motion.requestPermission(),o["a"].motion.startNotifications({},(t=>{d.push(t)}),(t=>{console.error("Error getting MotionEvent",t)})))}catch(t){console.error("Issues getting MotionEvent",t)}},startTimer(){this.totalTime=l,this.timer=setInterval((()=>this.countDown()),1e3),c["a"].methods.play()},stopTimer(){clearInterval(this.timer),c["a"].methods.stop()},countDown(){this.totalTime>=1?this.totalTime--:this.completeTest()},completeTest(){this.isStarted=!1,this.stopTimer(),o["a"].orientation.stopNotifications(),o["a"].motion.stopNotifications(),o["a"].screen.allowSleep(),this.isCompleted=!0;let t={userKey:n["a"].user._key,participantKey:n["a"].user.participantKey,studyKey:this.studyKey,taskId:parseInt(this.taskId),taskType:"tugt",createdTS:new Date,phone:o["a"].device,summary:{startedTS:this.startedTS,completedTS:new Date,durationMs:(new Date).getTime()-this.startedTS.getTime()},data:{motion:d,orientation:m}};this.$router.push({name:"tugtSummary",params:{report:t}})}},computed:{minutes(){return r["c"].pad(Math.floor(this.totalTime/60))},seconds(){return r["c"].pad(this.totalTime-60*this.minutes)}},beforeDestroy:function(){m=[],d=[],this.stopTimer(),o["a"].screen.allowSleep(),o["a"].orientation.stopNotifications(),o["a"].motion.stopNotifications()}},u=p,h=(s("70c7"),s("2877")),T=s("9989"),w=s("9c40"),v=s("eebe"),g=s.n(v),y=Object(h["a"])(u,i,a,!1,null,"2a79533b",null);e["default"]=y.exports;g()(y,"components",{QPage:T["a"],QBtn:w["a"]})},6372:function(t,e,s){},"70c7":function(t,e,s){"use strict";s("6372")}}]);