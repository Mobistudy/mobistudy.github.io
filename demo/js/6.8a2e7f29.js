(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"14b3":function(e,t,n){},6387:function(e,t,n){"use strict";var i=n("14b3"),r=n.n(i);r.a},"75a1":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{attrs:{padding:""}},[e.introduction?n("div",[n("div",{staticClass:"text-center text-h5"},[e._v("\n      "+e._s(e.introduction.title[e.$i18n.locale])+"\n    ")]),n("div",{staticClass:"text-center text-body1 q-mt-lg"},[n("div",{domProps:{innerHTML:e._s(e.introduction.description[e.$i18n.locale])}})]),n("div",{staticClass:"row justify-center q-mt-lg"},[n("q-btn",{attrs:{color:"primary",label:e.$t("common.start")},on:{click:function(t){return e.start()}}})],1)]):e._e(),e.introduction||e.finished?e._e():n("div",[n("transition",{attrs:{"enter-active-class":"animated "+this.slideName,"leave-active-class":"fadeOut",mode:"out-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.slideName,expression:"slideName != ''"}],key:""},[n("div",{staticClass:"text-center text-subtitle1"},[n("div",{domProps:{innerHTML:e._s(e.currentQuestion.text[e.$i18n.locale])}})]),e.currentQuestion.helper?n("div",{staticClass:"text-center text-subtitle2 q-mb-md"},[n("div",{domProps:{innerHTML:e._s(e.currentQuestion.helper[e.$i18n.locale])}})]):e._e(),n("q-input",{directives:[{name:"show",rawName:"v-show",value:"freetext"===e.currentQuestion.type,expression:"currentQuestion.type === 'freetext'"}],attrs:{type:"textarea",label:e.$t("studies.tasks.form.freeTextExplanation"),rows:"3",outlined:""},model:{value:e.freetextAnswer,callback:function(t){e.freetextAnswer=t},expression:"freetextAnswer"}}),e._l(e.currentQuestion.answerChoices,(function(t,i){return n("div",{directives:[{name:"show",rawName:"v-show",value:"singleChoice"===e.currentQuestion.type,expression:"currentQuestion.type === 'singleChoice'"}],key:"sc"+i},[n("q-radio",{attrs:{val:t.id,label:t.text[e.$i18n.locale]},model:{value:e.singleChoiceAnswer,callback:function(t){e.singleChoiceAnswer=t},expression:"singleChoiceAnswer"}})],1)})),e._l(e.currentQuestion.answerChoices,(function(t,i){return n("div",{directives:[{name:"show",rawName:"v-show",value:"multiChoice"===e.currentQuestion.type,expression:"currentQuestion.type === 'multiChoice'"}],key:"mc"+i},[n("q-checkbox",{attrs:{val:t.id,label:t.text[e.$i18n.locale]},model:{value:e.multiChoiceAnswer,callback:function(t){e.multiChoiceAnswer=t},expression:"multiChoiceAnswer"}})],1)})),n("div",{directives:[{name:"show",rawName:"v-show",value:"textOnly"===e.currentQuestion.type,expression:"currentQuestion.type === 'textOnly'"}],staticClass:"text-subtitle1 q-mb-md"},["textOnly"===e.currentQuestion.type?n("div",[n("div",{domProps:{innerHTML:e._s(e.currentQuestion.html[e.$i18n.locale])}})]):e._e()]),"textOnly"!==e.currentQuestion.type?n("div",{staticClass:"row justify-around"},[n("q-btn",{attrs:{"no-caps":"",flat:"",label:e.$t("common.clear"),color:"negative","icon-right":"cancel"},on:{click:function(t){return e.clearAnswer()}}})],1):e._e()],2)]),n("div",{staticClass:"row justify-around q-mb-xl"},[n("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.isFirstQuestion,expression:"!isFirstQuestion"}],attrs:{icon:"arrow_back",color:"secondary",label:e.$t("common.back")},on:{click:function(t){return e.back()}}}),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.isAnswered,expression:"isAnswered"}],attrs:{"icon-right":"arrow_forward",color:"primary",label:e.$t("common.next")},on:{click:function(t){return e.next()}}}),n("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.isAnswered,expression:"!isAnswered"}],attrs:{"icon-right":"arrow_forward",color:"warning",label:e.$t("common.skip")},on:{click:function(t){return e.next()}},model:{value:e.singleChoiceAnswer,callback:function(t){e.singleChoiceAnswer=t},expression:"singleChoiceAnswer"}})],1),e.currentQuestion.footer?n("div",{staticClass:"text-left text-caption absolute-bottom q-pa-sm"},[e._v("\n      "+e._s(e.currentQuestion.footer[e.$i18n.locale])+"\n    ")]):e._e()],1),e.finished?n("div",[n("div",{staticClass:"text-center text-h6"},[e._v("\n      "+e._s(e.$t("studies.tasks.form.formCompleted"))+"\n    ")]),n("div",{staticClass:"row justify-around q-ma-lg"},[n("q-btn",{attrs:{color:"primary",loading:e.loading,label:e.$t("common.send")},on:{click:function(t){return e.send()}}})],1)]):e._e()])},r=[],s=(n("ac6a"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("06db"),n("20d6"),n("7514"),n("967e")),o=n.n(s),a=(n("7f7f"),n("96cf"),n("fa84")),c=n.n(a),u=(n("c5f6"),n("aa9c")),l=n("6a6d"),d=n("9bf1");function h(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function f(e,t){if(e){if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var w={name:"FormPage",props:{studyKey:String,taskId:Number,formKey:String},data:function(){return{formDescr:{},responses:[],freetextAnswer:void 0,singleChoiceAnswer:void 0,multiChoiceAnswer:[],introduction:{title:"",description:""},finished:!1,currentQuestion:void 0,loading:!1,slideName:""}},created:function(){var e=this;return c()(o.a.mark((function t(){var n,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.formKey,console.log("Form Key:",n),t.prev=2,t.next=5,l["a"].getFormDescription(n);case 5:if(i=t.sent,i){t.next=14;break}return e.$q.loading.show(),t.next=10,u["a"].getForm(n);case 10:return i=t.sent,t.next=13,l["a"].setFormDescription(n,i);case 13:e.$q.loading.hide();case 14:e.formDescr=i,e.introduction={title:e.formDescr.name,description:e.formDescr.description},t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](2),console.error(t.t0),e.$q.notify({color:"negative",message:"Cannot retrieve information about the form: "+t.t0.message,icon:"report_problem",onDismiss:function(){this.$router.go(-1)}});case 22:case"end":return t.stop()}}),t,null,[[2,18]])})))()},computed:{isFirstQuestion:function(){return!this.introduction&&this.currentQuestion.id===this.formDescr.questions[0].id},isAnswered:function(){return"singleChoice"===this.currentQuestion.type&&this.singleChoiceAnswer||"freetext"===this.currentQuestion.type&&this.freetextAnswer||"multiChoice"===this.currentQuestion.type&&this.multiChoiceAnswer.length||"textOnly"===this.currentQuestion.type}},methods:{start:function(){var e=this;this.introduction=!1,this.currentQuestion=this.formDescr.questions[0],setTimeout((function(){e.slideName="fadeInDown"}),10)},next:function(){var e=this;this.slideName="";var t=this.currentQuestion.nextDefaultId,n={questionId:this.currentQuestion.id,questionType:this.currentQuestion.type,questionText:this.currentQuestion.text,answer:void 0,timeStamp:new Date};if("freetext"===this.currentQuestion.type)n.answer=this.freetextAnswer;else if("singleChoice"===this.currentQuestion.type){var i=this.currentQuestion.answerChoices.find((function(t){return t.id===e.singleChoiceAnswer}));i&&(n.answer={answerText:i.text,answerId:i.id},i.nextQuestionId&&(t=i.nextQuestionId))}else if("multiChoice"===this.currentQuestion.type){n.answer=[];var r,s=h(this.multiChoiceAnswer);try{var o=function(){var t=r.value,i=e.currentQuestion.answerChoices.find((function(e){return e.id===t}));n.answer.push({answerText:i.text,answerId:i.id})};for(s.s();!(r=s.n()).done;)o()}catch(c){s.e(c)}finally{s.f()}}if(this.responses.push(n),this.freetextAnswer=void 0,this.multiChoice=void 0,this.singleChoiceAnswer=void 0,!t)if(this.currentQuestion.id===this.formDescr.questions[this.formDescr.questions.length-1].id)t="ENDFORM";else{var a=this.formDescr.questions.findIndex((function(t){return t.id===e.currentQuestion.id}));t="Q"+(a+2)}"ENDFORM"===t?this.finished=!0:this.currentQuestion=this.formDescr.questions.find((function(e){return e.id===t})),setTimeout((function(){e.slideName="slideInRight"}),10)},back:function(){var e=this;this.slideName="",this.freetextAnswer=void 0,this.multiChoice=void 0,this.singleChoiceAnswer=void 0;var t=this.responses[this.responses.length-1];this.currentQuestion=this.formDescr.questions.find((function(e){return e.id===t.questionId})),t.answer&&("freetext"===this.currentQuestion.type?this.freetextAnswer=t.answer:"singleChoice"===this.currentQuestion.type?this.singleChoiceAnswer=t.answer.answerId:"multiChoice"===this.currentQuestion.type&&(this.multiChoice=t.map((function(e){return e.answer.answerId})))),this.responses.pop(),setTimeout((function(){e.slideName="slideInLeft"}),10)},send:function(){var e=this;return c()(o.a.mark((function t(){var n,i,r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,n=e.studyKey,i=Number(e.taskId),r={userKey:d["a"].user._key,studyKey:n,taskId:i,createdTS:new Date,responses:e.responses},t.prev=4,t.next=7,u["a"].sendAnswers(r);case 7:return t.next=9,l["a"].setTaskCompletion(n,i,new Date);case 9:e.$router.push("/home"),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](4),console.error(t.t0),e.loading=!1,e.$q.notify({color:"negative",message:e.$t("errors.connectionError")+" "+t.t0.message,icon:"report_problem",onDismiss:function(){this.$router.push("/home")}});case 17:case"end":return t.stop()}}),t,null,[[4,12]])})))()},clearAnswer:function(){"singleChoice"===this.currentQuestion.type&&(this.singleChoiceAnswer=void 0),"freetext"===this.currentQuestion.type&&(this.freetextAnswer=void 0),"multiChoice"===this.currentQuestion.type&&(this.multiChoiceAnswer=[])}}},p=w,v=(n("6387"),n("2877")),x=n("9989"),y=n("9c40"),b=n("27f9"),g=n("3786"),C=n("8f8e"),Q=n("eebe"),A=n.n(Q),k=Object(v["a"])(p,i,r,!1,null,"1e60fc3b",null);t["default"]=k.exports;A()(k,"components",{QPage:x["a"],QBtn:y["a"],QInput:b["a"],QRadio:g["a"],QCheckbox:C["a"]})}}]);