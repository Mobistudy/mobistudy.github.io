(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{"4d6a":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{attrs:{padding:""}},[e._l(e.newStudies,(function(t,s){return n("q-card",{key:s,staticClass:"q-mb-md",attrs:{bordered:""}},[n("q-card-section",[n("div",{staticClass:"row no-wrap"},[n("div",{staticClass:"col"},[n("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("studies.newStudyInvite")))]),n("div",{staticClass:"text-subtitle1"},[e._v(e._s(t.generalities.title[e.$i18n.locale]))]),n("div",{staticClass:"text-subtitle2"},[e._v(e._s(t.generalities.shortDescription[e.$i18n.locale]))])])])]),n("q-card-section",[e._v("\n        "+e._s(e.$t("studies.newStudyExtraCriteria"))+":\n        "),e._l(t.inclusionCriteria.criteriaQuestions,(function(t,i){return n("div",{key:i},[n("p",{staticClass:"q-mt-md text-subtitle2"},[e._v(e._s(t.title[e.$i18n.locale]))]),n("div",{staticClass:"row"},[n("q-radio",{staticClass:"col",attrs:{val:"yes",label:e.$t("common.yes")},model:{value:e.newStudiesCustomAnswers[s][i],callback:function(t){e.$set(e.newStudiesCustomAnswers[s],i,t)},expression:"newStudiesCustomAnswers[studyIndex][questionIndex]"}}),n("q-radio",{staticClass:"col",attrs:{val:"no",label:e.$t("common.no")},model:{value:e.newStudiesCustomAnswers[s][i],callback:function(t){e.$set(e.newStudiesCustomAnswers[s],i,t)},expression:"newStudiesCustomAnswers[studyIndex][questionIndex]"}})],1)])}))],2),n("q-separator"),n("div",{staticClass:"q-ma-sm text-negative",attrs:{color:"negative"}},[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.eligible[s]&&e.newStudiesCustomAnswers[s].length===t.inclusionCriteria.criteriaQuestions.length,expression:"!eligible[studyIndex] && newStudiesCustomAnswers[studyIndex].length === study.inclusionCriteria.criteriaQuestions.length"}]},[e._v("\n          "+e._s(e.$t("studies.notEligible"))+"\n        ")])]),n("q-card-actions",{attrs:{align:"around"}},[n("q-btn",{attrs:{flat:"",color:"negative",label:e.$t("studies.discardStudy")},on:{click:function(t){return e.discardStudy(s)}}}),n("q-btn",{attrs:{color:"primary",label:e.$t("studies.joinStudy"),disable:!e.eligible[s]},on:{click:function(t){return e.joinStudy(s)}}})],1)],1)})),n("q-list",{attrs:{separator:"",bordered:""}},[n("q-item-label",{attrs:{header:""}},[e._v(e._s(e.$t("studies.activeStudies")))]),e._l(e.activeStudies,(function(t,s){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"ps"+s,attrs:{clickable:""},nativeOn:{click:function(n){return e.showDetails(t)}}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{color:"primary",name:"settings"}})],1),n("q-item-section",[n("q-item-label",[e._v(e._s(t.generalities.title[e.$i18n.locale]))]),n("q-item-label",{attrs:{caption:"",lines:"1"}},[e._v("End Date: "+e._s(e.nicerDate(t.generalities.endDate)))])],1)],1)})),0===e.activeStudies.length?n("q-item",[n("q-item-section",[e._v(e._s(e.$t("studies.noActiveStudies")))])],1):e._e(),0!==e.previousStudies.length?n("q-separator"):e._e(),0!==e.previousStudies.length?n("q-item-label",{attrs:{header:""}},[e._v(e._s(e.$t("studies.previousStudies")))]):e._e(),e._l(e.previousStudies,(function(t,s){return n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"ps"+s,attrs:{clickable:""},nativeOn:{click:function(n){return e.showDetails(t)}}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{color:"primary",name:"settings"}})],1),n("q-item-section",[n("q-item-label",[e._v(e._s(t.generalities.title[e.$i18n.locale]))])],1)],1)}))],2)],2)},i=[],r=(n("ac6a"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("7f7f"),n("6b54"),n("06db"),n("967e")),a=n.n(r),o=(n("96cf"),n("fa84")),c=n.n(o),u=n("9bf1"),l=n("6a6d"),d=n("aa9c"),p=n("bd4c");function m(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=v(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var s=0,i=function(){};return{s:i,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function v(e,t){if(e){if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var f={name:"Studies",data:function(){return{newStudies:[],newStudiesCustomAnswers:[],activeStudies:[],previousStudies:[]}},created:function(){var e=this;return c()(a.a.mark((function t(){var n,s,i,r,o,c,u,p,v,w;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.prev=1,t.next=4,d["a"].getNewStudiesKeys();case 4:n=t.sent,s=0;case 6:if(!(s<n.length)){t.next=16;break}return i=n[s],t.next=10,d["a"].getStudyDescription(i);case 10:r=t.sent,e.newStudiesCustomAnswers.push([]),e.newStudies.push(r);case 13:s++,t.next=6;break;case 16:return t.next=18,l["a"].getStudiesParticipation();case 18:if(o=t.sent,!o){t.next=47;break}c=m(o),t.prev=21,c.s();case 23:if((u=c.n()).done){t.next=39;break}if(p=u.value,"accepted"!==p.currentStatus){t.next=32;break}return t.next=28,l["a"].getStudyDescription(p.studyKey);case 28:v=t.sent,e.activeStudies.push(v),t.next=37;break;case 32:if("withdrawn"!==p.currentStatus&&"completed"!==p.currentStatus){t.next=37;break}return t.next=35,l["a"].getStudyDescription(p.studyKey);case 35:w=t.sent,e.previousStudies.push(w);case 37:t.next=23;break;case 39:t.next=44;break;case 41:t.prev=41,t.t0=t["catch"](21),c.e(t.t0);case 44:return t.prev=44,c.f(),t.finish(44);case 47:t.next=53;break;case 49:t.prev=49,t.t1=t["catch"](1),console.error("Cannot connect to server",t.t1),e.$q.notify({color:"negative",message:e.$i18n.t("errors.connectionError")+": "+t.t1.message,icon:"report_problem"});case 53:e.$q.loading.hide();case 54:case"end":return t.stop()}}),t,null,[[1,49],[21,41,44,47]])})))()},computed:{eligible:function(){for(var e=[],t=0;t<this.newStudies.length;t++){var n=this.newStudies[t];if(n.inclusionCriteria.criteriaQuestions&&0!==n.inclusionCriteria.criteriaQuestions.length){for(var s=!0,i=0;i<n.inclusionCriteria.criteriaQuestions.length;i++)if(n.inclusionCriteria.criteriaQuestions[i].answer!==this.newStudiesCustomAnswers[t][i]){s=!1;break}e.push(s)}else e.push(!0)}return e}},methods:{nicerDate:function(e){return p["b"].formatDate(e,"YYYY/MM/DD")},showDetails:function(e){this.$router.push({name:"studyConfig",params:{studyDescription:e}})},discardStudy:function(e){var t=this;return c()(a.a.mark((function n(){return a.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$q.dialog({title:t.$i18n.t("studies.discardStudy"),message:t.$i18n.t("studies.discardStudyConfirm"),color:"primary",ok:t.$i18n.t("common.yes"),cancel:t.$i18n.t("common.cancel")}).onOk(c()(a.a.mark((function n(){var s,i,r;return a.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s=t.newStudies[e],i={studyKey:s._key},t.eligible[e]||t.newStudiesCustomAnswers[e].length!==s.inclusionCriteria.criteriaQuestions.length?(i.currentStatus="rejected",i.rejectedTS=new Date):(i.currentStatus="excluded",i.excludedTS=new Date,i.criteriaAnswers=t.newStudiesCustomAnswers[e]),n.prev=3,n.next=6,d["a"].updateStudyStatus(u["a"].user._key,s._key,i);case 6:return n.next=8,l["a"].getStudiesParticipation();case 8:return r=n.sent,r||(r=[]),r.push(i),n.next=13,l["a"].setStudiesParticipation(r);case 13:t.newStudies.splice(e,1),t.newStudiesCustomAnswers.splice(e,1),t.$router.push({name:"tasker",params:{rescheduleTasks:!1,checkNewStudies:!0}}),n.next=22;break;case 18:n.prev=18,n.t0=n["catch"](3),console.error("Cannot connect to server",n.t0),t.$q.notify({color:"negative",message:t.$i18n.t("errors.connectionError")+": "+n.t0.message,icon:"report_problem"});case 22:case"end":return n.stop()}}),n,null,[[3,18]])}))));case 1:case"end":return n.stop()}}),n)})))()},joinStudy:function(e){var t=this;return c()(a.a.mark((function n(){var s;return a.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:s=t.newStudies[e],t.$router.push({name:"invitation",params:{studyDescription:s}});case 2:case"end":return n.stop()}}),n)})))()}}},S=f,h=n("2877"),b=n("9989"),y=n("f09f"),g=n("a370"),x=n("3786"),C=n("eb85"),k=n("4b7e"),_=n("9c40"),q=n("1c1c"),$=n("0170"),A=n("66e5"),Q=n("4074"),D=n("0016"),I=n("714f"),j=n("eebe"),E=n.n(j),O=Object(h["a"])(S,s,i,!1,null,null,null);t["default"]=O.exports;E()(O,"components",{QPage:b["a"],QCard:y["a"],QCardSection:g["a"],QRadio:x["a"],QSeparator:C["a"],QCardActions:k["a"],QBtn:_["a"],QList:q["a"],QItemLabel:$["a"],QItem:A["a"],QItemSection:Q["a"],QIcon:D["a"]}),E()(O,"directives",{Ripple:I["a"]})}}]);