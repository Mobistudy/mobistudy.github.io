(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[59],{e05f:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("q-page",{attrs:{padding:""}},[t("div",{staticClass:"text-center"},[t("div",{staticClass:"text-h5"},[e._v(e._s(e.$t("studies.tasks.peakflow.results")))])]),t("div",{staticClass:"q-pa-md"},[t("canvas",{ref:"lineChart",staticStyle:{margin:"0 auto","padding-right":"2rem"},attrs:{height:"320"}}),t("div",{staticClass:"row justify-around"},[t("q-btn",{attrs:{label:"-1 "+e.$t("studies.tasks.peakflow.weeks"),color:"secondary",disable:e.disablePlus},on:{click:function(t){e.lineChartAdd(1)}}}),t("q-btn",{attrs:{label:"+1 "+e.$t("studies.tasks.peakflow.weeks"),color:"secondary",disable:e.disableMinus},on:{click:function(t){e.lineChartAdd(-1)}}})],1)]),t("div",{staticClass:"row justify-center q-mt-lg"},[t("q-btn",{attrs:{color:"primary",label:e.$t("common.complete")},on:{click:e.completeTest}})],1)])},i=[],r=(a("14d9"),a("6a6d")),n=a("30ef"),l=a.n(n),d={pef:[],labels:[],reset(){this.pef=[],this.labels=[]}};let o=[];var h={name:"PeakFlowSummaryPage",props:{report:Object},data:function(){return{lineChart:void 0,currentStartWeek:0,currentEndWeek:2,disableMinus:!0,disablePlus:!1,startDate:new Date,pefMax:void 0}},methods:{async downloadData(){o=[],d.reset();try{o=await r["a"].getPastPeakFlowMeas(),this.renderLineChart(this.currentStartWeek,this.currentEndWeek)}catch(e){console.error("cannot download data",e)}},renderLineChart(e,t){d.reset();let a=7*e,s=7*t-1;s>o.length&&(s=o.length-1);for(let i=a;i<=s;i++){let e=o[i];this.addToLineChart(e.pefMax,e.createdTS)}this.updateLineChartReferences(),this.updatePlusMinusButtons()},addToLineChart(e,t){d.pef.push({x:t,y:e}),d.labels.push(t)},updateLineChartReferences(){this.lineChart.data.datasets[0].data=d.pef,this.lineChart.data.labels=d.labels,this.lineChart.update()},createPeakFlowLineChart(){let e=this.$refs.lineChart;this.lineChart=new l.a.Scatter(e,{type:"scatter",data:{labels:d.labels,datasets:[{label:this.$t("studies.tasks.peakflow.pef"),data:d.pef,backgroundColor:"#4038C7",borderColor:"#4038C7",borderWidth:0,pointRadius:4,fill:!1,lineTension:0,showLine:!0}]},options:{responsive:!0,title:{display:!1},scales:{xAxes:[{type:"time",time:{displayFormats:{day:"DD/MM hA"}},scaleLabel:{display:!0,lineChartLabelstring:"Date"}}],yAxes:[{scaleLabel:{display:!0,lineChartLabelstring:"value"}}]}}}),this.lineChart.update()},lineChartAdd(e){this.currentStartWeek+=e,this.currentEndWeek+=e,this.renderLineChart(this.currentStartWeek,this.currentEndWeek),this.updatePlusMinusButtons()},updatePlusMinusButtons(){0===this.currentStartWeek?this.disableMinus=!0:this.disableMinus=!1,this.currentEndWeek>=o.length/7?this.disablePlus=!0:this.disablePlus=!1},completeTest(){this.$router.push("/home")}},async mounted(){this.createPeakFlowLineChart(),await this.downloadData()}},u=h,c=a("2877"),p=a("9989"),b=a("9c40"),C=a("eebe"),k=a.n(C),f=Object(c["a"])(u,s,i,!1,null,null,null);t["default"]=f.exports;k()(f,"components",{QPage:p["a"],QBtn:b["a"]})}}]);