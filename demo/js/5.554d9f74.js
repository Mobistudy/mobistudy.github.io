(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"5caf":function(t,e,s){"use strict";s("688a")},"688a":function(t,e,s){},a726:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"text-center text-h5 q-mt-lg"},[t._v("\n    "+t._s(t.$t("studies.tasks.qcst.title"))+"\n  ")]),s("p",{attrs:{id:"timer"}},[t._v(" "+t._s(t.minutes)+":"+t._s(t.seconds)+" ")]),s("div",{staticClass:"row justify-center q-mt-lg"},[t.isStarted?t._e():s("q-btn",{attrs:{color:"primary",label:t.$t("common.start"),padding:"lg"},on:{click:t.startTest}}),t.isStarted?s("q-btn",{attrs:{color:"secondary",label:t.$t("common.complete"),padding:"lg"},on:{click:t.completeTest}}):t._e()],1),t.isStarted?s("q-btn",{ref:"metronome_indicator",staticClass:"q-mt-xl",attrs:{padding:"xl",color:"black",round:"",flat:"",icon:"volume_up"}}):t._e()],1)},i=[],n=(s("e6cf"),s("efed")),a={metronome:{metronomeID:null,audioContext:null,nextNoteTime:0,currentQuarterNote:0,volume:.2,scheduleBeeping(t,e){const s=this.audioContext.createOscillator(),o=this.audioContext.createGain();s.frequency.value=t%4===0?1e3:800,o.gain.value=this.volume,o.gain.exponentialRampToValueAtTime(this.volume,e+.001),o.gain.exponentialRampToValueAtTime(.001,e+.02),s.connect(o),o.connect(this.audioContext.destination),s.start(e),s.stop(e+.03)},nextBeep(t){let e=625===t?96:88,s=60/e;this.nextNoteTime+=s,this.currentQuarterNote++,4===this.currentQuarterNote&&(this.currentQuarterNote=0)},start(t,e){const s=window.AudioContext||window.webkitAudioContext;this.audioContext=new s,this.currentQuarterNote=0,this.nextNoteTime=this.audioContext.currentTime+.05,this.metronomeID=setInterval((()=>{while(this.nextNoteTime<this.audioContext.currentTime+.1)this.scheduleBeeping(this.currentQuarterNote,this.nextNoteTime),this.nextBeep(t),e.click()}),25)},stop(){clearInterval(this.metronomeID),console.log("Stopping metronome")}},media:{playSound(t){if(void 0!==t){var e=new Audio(t.currentSrc);e.play()}}},textToSpeech:{speech:null,language:null,volume:1,playVoice(t){"speechSynthesis"in window?(this.speech=new SpeechSynthesisUtterance,this.speech.volume=this.volume,this.speech.text=t,this.speech.lang=this.language,console.log(this.speech),null!==this.speech&&window.speechSynthesis.speak(this.speech)):console.log("Text-to-speech is not supported on this device")}}},r=s("9bf1"),c=s("7937");const l=180;var u={name:"QCSTPage",props:{studyKey:String,taskId:Number},components:{},data:function(){return{isStarted:!1,isCompleted:!1,timer:null,countDown:l,startedTS:void 0,completionTS:void 0,steps:[],gender:r["a"].user.gender,heartRate:"",cadence:"male"===r["a"].user.gender?625:681}},methods:{async startTest(){this.isStarted||(this.isStarted=!0,this.startedTS=new Date,a.textToSpeech.language=r["a"].user.language,await n["a"].pedometer.isAvailable()?n["a"].pedometer.startNotifications({},(t=>{console.log("Got steps",t),this.steps.push(t)}),(t=>{console.error("Error getting steps",t)})):console.error("Pedometer not available"),a.textToSpeech.playVoice(this.$i18n.t("studies.tasks.qcst.begin")),this.timer=setInterval((()=>{120===this.countDown?a.textToSpeech.playVoice(this.$i18n.t("studies.tasks.qcst.twoMin")):60===this.countDown&&a.textToSpeech.playVoice(this.$i18n.t("studies.tasks.qcst.oneMin")),this.countDown>=1?this.countDown--:(this.isStarted=!1,this.completeTest())}),1e3),a.metronome.start(this.cadence,this.$refs.metronome_indicator.$el))},completeTest(){a.textToSpeech.playVoice(this.$i18n.t("studies.tasks.qcst.time")),n["a"].pedometer.stopNotifications(),this.completionTS=new Date;const t=this.studyKey,e=parseInt(this.taskId),s=r["a"].user._key;let o={userKey:s,studyKey:t,taskId:e,createdTS:new Date,startedTS:this.startedTS,completionTS:this.completionTS,steps:this.steps,heartRate:void 0,borgScale:void 0};this.$router.push({name:"qcsthr",params:{report:o}})}},computed:{minutes(){return c["c"].pad(Math.floor(this.countDown/60),2)},seconds(){return c["c"].pad(this.countDown-60*this.minutes,2)}},beforeDestroy:function(){this.isStarted=!1,clearInterval(this.timer),a.metronome.stop(),n["a"].pedometer.stopNotifications()}},h=u,d=(s("5caf"),s("2877")),p=s("9989"),m=s("9c40"),g=s("eebe"),S=s.n(g),T=Object(d["a"])(h,o,i,!1,null,"78888dc2",null);e["default"]=T.exports;S()(T,"components",{QPage:p["a"],QBtn:m["a"]})}}]);