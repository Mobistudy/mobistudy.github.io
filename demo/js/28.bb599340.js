(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"906a":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("q-page",{attrs:{padding:""}},[e("div",{staticClass:"text-h5 text-center"},[t._v("\n    "+t._s(t.$t("studies.consent.informedConsent"))+"\n  ")]),e("div",{staticClass:"text-body2"},[t._v("\n    "+t._s(t.$t("studies.consent.consentExplanation"))+"\n  ")]),e("consents",{attrs:{studyDescription:t.studyDescription},model:{value:t.studyParticipation,callback:function(s){t.studyParticipation=s},expression:"studyParticipation"}}),e("div",{staticClass:"q-my-md row justify-evenly"},[e("q-btn",{attrs:{label:t.$t("common.reject"),color:"negative",flat:""},on:{click:function(s){return t.deny()}}}),e("q-btn",{attrs:{label:t.$t("studies.consent.joinStudy"),color:"primary",disabled:!t.canAccept},on:{click:function(s){return t.accept()}}})],1)],1)},n=[],a=(e("e6cf"),e("b6bd")),o=e("9bf1"),c=e("6a6d"),r=e("aa9c"),d={name:"ConsentItemsPage",props:["studyDescription"],components:{Consents:a["a"]},data(){return{studyParticipation:{studyKey:this.studyDescription._key,currentStatus:void 0,acceptedTS:void 0,reminders:!1,taskItemsConsent:[],extraItemsConsent:[]}}},async created(){if(this.studyDescription.consent.extraItems&&this.studyDescription.consent.extraItems.length)for(let t=0;t<this.studyDescription.consent.extraItems.length;t++)this.studyParticipation.extraItemsConsent.push({consented:!1});for(let t=0;t<this.studyDescription.consent.taskItems.length;t++)this.studyParticipation.taskItemsConsent.push({taskId:this.studyDescription.consent.taskItems[t].taskId,consented:!1})},computed:{canAccept(){if(this.studyDescription.consent.extraItems&&this.studyDescription.consent.extraItems.length)for(let t=0;t<this.studyDescription.consent.extraItems.length;t++)if(!this.studyDescription.consent.extraItems[t].optional&&!this.studyParticipation.extraItemsConsent.consented)return!1;return!0}},methods:{async accept(){try{this.studyParticipation.currentStatus="accepted",this.studyParticipation.acceptedTS=new Date,console.log("/////",this.studyParticipation),await r["a"].updateStudyStatus(o["a"].user._key,this.studyDescription._key,this.studyParticipation);let t=await c["a"].getStudiesParticipation();t||(t=[]),t.push(this.studyParticipation),await c["a"].setStudiesParticipation(t),this.$router.push({name:"studies"})}catch(t){console.error("Cannot join study",t),this.$q.notify({color:"negative",message:this.$i18n.t("errors.connectionError")+": "+t.message,icon:"report_problem"})}this.$router.push({name:"accepted",params:{studyDescription:this.studyDescription}})},async deny(){this.$q.dialog({title:this.$i18n.t("studies.discardStudy"),message:this.$i18n.t("studies.discardStudyConfirm"),color:"primary",ok:this.$i18n.t("common.yes"),cancel:this.$i18n.t("common.cancel")}).onOk((async()=>{this.studyParticipation.currentStatus="rejected",this.studyParticipation.rejectedTS=new Date;try{await r["a"].updateStudyStatus(o["a"].user._key,this.studyDescription._key,this.studyParticipation);let t=await c["a"].getStudiesParticipation();t||(t=[]),t.push(this.studyParticipation),await c["a"].setStudiesParticipation(t),this.$router.push({name:"studies"})}catch(t){console.error("Cannot connect to server",t),this.$q.notify({color:"negative",message:this.$i18n.t("errors.connectionError")+": "+t.message,icon:"report_problem"})}}))}}},u=d,p=e("2877"),y=e("9989"),h=e("9c40"),l=e("eebe"),m=e.n(l),P=Object(p["a"])(u,i,n,!1,null,null,null);s["default"]=P.exports;m()(P,"components",{QPage:y["a"],QBtn:h["a"]})}}]);